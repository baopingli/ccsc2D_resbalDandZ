对代码中的2D代码进行了自适应，可能效果不好但是也算是工作。对D和Z都进行了自适应，按照SPORCO代码进行的。